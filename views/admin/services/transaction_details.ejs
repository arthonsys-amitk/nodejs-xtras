<%-include('../header') %> 
<%-include('../sidebar') %>
   <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        View Transaction
      </h1>
      <ol class="breadcrumb">
        <li><a href="/admin"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="/admin/transaction_list">View Transactions</a></li>
        <li class="active">View Details</li>
      </ol>
    </section>
    <!-- Main content -->
    <section class="content">

      <div class="row">
        <div class="col-md-3">
 <% if (locals.flashmessages) { %>
    <div class="alert alert-<%=flashmessages.alert_type%> alert-dismissible">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
      <%=flashmessages.alert_msg%>
    </div>
    <% } %>
          <!-- Profile Image -->
          <div class="box box-primary">
            <div class="box-body box-profile">				
              <h4 class=" text-center">Transaction Details</h4>
            </div>
          </div>  
        </div>
        <!-- /.col -->
        <div class="col-md-9">
          <div class="alert alert-success" id="success_alert" style="display: none;">
  <strong>Success!</strong>
</div>

          <div class="nav-tabs-custom">
            <ul class="nav nav-tabs">
              <li class="active"><a href="#summary" data-toggle="tab">Summary</a></li>
              <li ><a href="#trandetail" data-toggle="tab">Transaction</a></li>
            </ul>
            <div class="tab-content">
              <div class="active tab-pane" id="summary">
                <form class="form-horizontal" >
                  <div class="form-group">
                    <label class="col-sm-4 control-label">Name</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=user.fullname%></label>
                    </div>
                  </div>
                  
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Amount</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=transaction.currency%> <%=parseFloat(transaction.amount/100).toFixed(2)%></label>
                    </div>
                  </div>
				  
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Date</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=transaction.created_at%></label>
                    </div>
                  </div>
				  
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Appointment ID</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=transaction.appointment_id%></label>
                    </div>
                  </div>
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Appointment Date</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=appointment_date%></label>
                    </div>
                  </div>
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Service Provider</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%=provider_name%></label>
                    </div>
                  </div>
				  <%
						var transaction_status = "Failed";
						if(transaction.payment_details != null && transaction.payment_details != undefined && transaction.payment_details.status != undefined && transaction.payment_details.status != null) {
							transaction_status = transaction.payment_details.status;
						}
						
						transaction_status = transaction_status.charAt(0).toUpperCase() + transaction_status.slice(1);
						if(transaction_status == "Succeeded")
							var transaction_status_html = "<span style='background: #00ff00; padding: 4px;'>" + transaction_status + "</span>";
						else
							var transaction_status_html = "<span style='background: #ff0000; padding: 4px;'>" + transaction_status + "</span>";
				  %>
				  <div class="form-group">
                    <label class="col-sm-4 control-label">Status</label>

                    <div class="col-sm-8">
                      <label class=" text-muted top-spaced"><%- transaction_status_html%></label>
                    </div>
                  </div>
				  
                </form>
              </div>
              
			  
			  <div class="tab-pane" id="trandetail">
                <form class="form-horizontal" >
                  <div class="form-group">
					<% if(transaction.payment_details == null || transaction.payment_details == undefined) { %>
						<div class="col-sm-12">
						  <label class=" text-muted top-spaced">Transaction Details not available</label>
						</div>
					<% } else if(transaction.payment_details.id == undefined || transaction.payment_details.id == null) { %>
						<div class="form-group">
							<label class="col-sm-4 control-label">Status Code</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.statusCode%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Code</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.code%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Message</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.message%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Request ID</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.requestId%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Token</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.token%></label>
							</div>
					    </div>
					<% } else if(transaction.payment_details.id) { %>
						<div class="form-group">
							<label class="col-sm-4 control-label">Status</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.status%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Transaction ID</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.id%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Object</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.object%></label>
							</div>
					    </div>						
						<div class="form-group">
							<label class="col-sm-4 control-label">Balance Transaction</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.balance_transaction%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Captured</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.captured%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">description</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.description%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">LiveMode</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.livemode%></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Paid</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.payment_details.paid %></label>
							</div>
					    </div>
						<div class="form-group">
							<label class="col-sm-4 control-label">Token</label>

							<div class="col-sm-8">
							  <label class=" text-muted top-spaced"><%=transaction.token%></label>
							</div>
					    </div>					
					<% } %>                    
                  </div>
				</form>
			 </div>
			  
            </div>
            <!-- /.tab-content -->
          </div>
          <!-- /.nav-tabs-custom -->
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->

    </section>
    <!-- /.content -->
  </div>
  <style>
  .top-spaced { padding-top: 7px; font-weight: 500; }
  </style>
  <%-include('../footer') %> 
  